{% extends 'base.html.twig' %}

{% block container %}
    <div class="container">
        <div class="row">
            <div class="col-12">

                <!-- MERCHANT LOGO START -->
                <div class="row">
                    <div class="col-12 text-center">
                        <img src="data:image/png;base64, {{ '' | merchant_log_path }}"
                             alt="merchant-log-path"
                             class="img-fluid w-50 px-4 py-2"/>
                    </div>
                </div>
                <!-- MERCHANT LOGO END -->

                <!-- BORDERED CONTAINER START -->
                <div class="row">
                    <div class="col-12">
                        <div class="bordered-top bordered-bottom text-center">
                            <strong>Фискални рачун</strong>
                        </div>
                    </div>
                </div>
                <!-- BORDERED CONTAINER END -->

                <!-- INVOICE INFO START -->
                <div class="row">
                    <div class="col-12">
                        <table class="table table-sm table-borderless">
                            <tr>
                                <td class="align-middle text-start">ПИБ:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.merchant.tin }}</td>
                            </tr>
                            <tr>
                                <td class="align-middle text-start">Предузеће:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.merchant.name }}</td>
                            </tr>
                            <tr>
                                <td class="align-middle text-start">Име:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.merchant.branchName }}</td>
                            </tr>
                            <tr>
                                <td class="align-middle text-start">Адреса:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.merchant.address }}</td>
                            </tr>
                            <tr>
                                <td class="align-middle text-start">Место:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.merchant.district }}</td>
                            </tr>

                            <tr>
                                <td class="align-middle text-start">Касир:</td>
                                <td class="align-middle text-end">
                                    {% if properties.getRequest.merchant.cashierDisplayType.value == 'IDENTIFIER' %}
                                        {{ properties.getRequest.cashier.id }}
                                    {% elseif properties.getRequest.merchant.cashierDisplayType.value == 'NAME' %}
                                        {{ properties.getRequest.cashier.name }}
                                    {% elseif properties.getRequest.merchant.cashierDisplayType.value == 'SURNAME' %}
                                        {{ properties.getRequest.cashier.surname }}
                                    {% elseif properties.getRequest.merchant.cashierDisplayType.value == 'NAME_SURNAME' %}
                                        {{
                                            properties.getRequest.cashier.name ~ ' ' ~
                                            properties.getRequest.cashier.surname
                                        }}
                                    {% elseif properties.getRequest.merchant.cashierDisplayType.value == 'FULL_NAME' %}
                                        {{
                                            properties.getRequest.cashier.id ~ ' - ' ~
                                            properties.getRequest.cashier.name ~ ' ' ~
                                            properties.getRequest.cashier.surname
                                        }}
                                    {% endif %}
                                </td>
                            </tr>

                            {% if properties.getRequest.buyerId is not empty %}
                                <tr>
                                    <td class="align-middle text-start">ПИБ купца:</td>
                                    <td class="align-middle text-end">{{ properties.getRequest.buyerId }}</td>
                                </tr>
                            {% endif %}

                            {% if properties.getRequest.buyerCostCenterId is not empty %}
                                <tr>
                                    <td class="align-middle text-start">Податак купца:</td>
                                    <td class="align-middle text-end">{{ properties.getRequest.buyerCostCenterId }}</td>
                                </tr>
                            {% endif %}

                            <tr>
                                <td class="align-middle text-start">ПОС број:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.invoiceNumber }}</td>
                            </tr>
                            <tr>
                                <td class="align-middle text-start">ПОС време:</td>
                                <td class="align-middle text-end">{{ properties.getRequest.issueDateTime | date('d.m.Y H:i:s') }}</td>
                            </tr>

                            {% if properties.getRequest.referentDocumentNumber is not empty %}
                                <tr>
                                    <td class="align-middle text-start">Реф. број:</td>
                                    <td class="align-middle text-end">{{ properties.getRequest.referentDocumentNumber }}</td>
                                </tr>
                            {% endif %}

                            {% if properties.getRequest.referentDocumentDateTime is not empty %}
                                <tr>
                                    <td class="align-middle text-start">Реф. број:</td>
                                    <td class="align-middle text-end">{{ properties.getRequest.referentDocumentDateTime }}</td>
                                </tr>
                            {% endif %}

                        </table>
                    </div>
                </div>
                <!-- INVOICE INFO END -->

                <!-- BORDERED CONTAINER START -->
                <div class="row">
                    <div class="col-12">
                        <div class="bordered-top bordered-bottom text-center">
                            Продаја
                        </div>
                    </div>
                </div>
                <!-- BORDERED CONTAINER END -->

                <!-- ITEMS START -->
                <div class="row">
                    <div class="col-12">
                        <small class="ps-0">Артикли:</small>
                        <table class="table table-sm table-borderless">
                            <tr>
                                <td class="text-start">Назив</td>
                                <td class="text-center">Цена</td>
                                <td class="text-center">Кол.</td>
                                <td class="text-end">Укупно</td>
                            </tr>
                            {% for item in properties.getRequest.items %}
                                <tr>
                                    <td colspan="4">{{ item.name }} ({{ item.labels | join(', ') }})</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td class="text-center">{{ item.unitPrice | decimal }}</td>
                                    <td class="text-center">{{ item.quantity | decimal }}</td>
                                    <td class="text-end">{{ item.amount | decimal }}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                </div>
                <!-- ITEMS END -->

                <!-- BORDERED CONTAINER START -->
                <div class="row">
                    <div class="col-12">
                        <div class="bordered-bottom">

                        </div>
                    </div>
                </div>
                <!-- BORDERED CONTAINER END -->

                <!-- ITEMS SUMMARY START -->
                <div class="row">
                    <div class="col-12">
                        <table class="table table-sm table-borderless">
                            <tr>
                                <td class="text-start">ЗА УПЛАТУ:</td>
                                <td class="text-end">{{ properties.getRequest.amount | decimal }}</td>
                            </tr>
                            {% for payment in properties.getRequest.payments %}
                                <tr>
                                    <td class="text-start">{{ payment.name }}:</td>
                                    <td class="text-end">{{ payment.amount | decimal }}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                </div>
                <!-- ITEMS SUMMARY END -->

                <!-- BORDERED CONTAINER START -->
                <div class="row">
                    <div class="col-12">
                        <div class="bordered-bottom">

                        </div>
                    </div>
                </div>
                <!-- BORDERED CONTAINER END -->

                <div class="row">
                    <div class="col-12">
                        <table class="table table-sm table-borderless">
                            <tr>
                                <td class="text-start">Ознака</td>
                                <td class="text-center">Назив</td>
                                <td class="text-center">Стопа</td>
                                <td class="text-end">Порез</td>
                            </tr>
                            {% for tax in properties.getTaxItems %}
                                <tr>
                                    <td class="text-start">{{ tax.label }}</td>
                                    <td class="text-center">{{ tax.name }}</td>
                                    <td class="text-end">{{ tax.rate | decimal }} %</td>
                                    <td class="text-end">{{ tax.amount | decimal }}</td>
                                </tr>
                            {% endfor %}
                            <tr class="bordered-top bordered-bottom">
                                <td colspan="3">Укупно порез:</td>
                                <td class="text-end">{{ properties.getTaxAmount | decimal }}</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- TAX CORE INVOICE DETAILS START -->
                <div class="row">
                    <div class="col-12">
                        <table class="table table-sm table-borderless">
                            <tr>
                                <td class="text-start">ПФР време:</td>
                                <td class="text-end">{{ properties.getSdcDateTime | date('d.m.Y H:i:s') }}</td>
                            </tr>
                            <tr>
                                <td class="text-start">ПФР бр. рачуна:</td>
                                <td class="text-end">{{ properties.getSdcInterfacesNumber }}</td>
                            </tr>
                            <tr class="bordered-bottom">
                                <td class="text-start">Бројач рачуна:</td>
                                <td class="text-end">{{ properties.getInvoiceCounter }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <!-- TAX CORE INVOICE DETAILS END -->

                <!-- QR CODE CONTAINER START -->
                <div class="row my-2">
                    <div class="col-12 text-center">
                        <img src="data:image/gif;base64, {{ properties.getVerificationQRCode }}"
                             alt="verification-qr-code"
                             id="verification-qr-code"
                             class="img-fluid"/>
                    </div>
                </div>
                <!-- QR CODE CONTAINER END -->

                <!-- BORDERED CONTAINER START -->
                <div class="row">
                    <div class="col-12">
                        <div class="text-center">
                            <strong>Крај фискалног рачуна</strong>
                        </div>
                    </div>
                </div>
                <!-- BORDERED CONTAINER END -->

            </div>
        </div>
    </div>
{% endblock %}